<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Giffer in a Gif Land</title>
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="assets/main.css" /> -->
    <!-- <script src="assets/main.js"></script> -->
</head>
<style>
    .card {
        width: 300px;
        border: 2px solid grey;
        margin: 20px;
    }
    .gif {
        width: 80%;
        margin: 5%;
    }
    .card-body {
        height: 50px;
    }
</style>

<body>

    <div class="container">
        <div class="row" >
            <div class="col-lg-12" id="buttonDisplay">

            </div>
        </div>
        <div class="row">
            <div class="col-lg-8" id="gifDisplay">

            </div>
            <div class="col-lg-4">
                <form role="form">
                    <div class="form-group row">
                        <label for="new-button-input">Add a new button</label>
                        <input class="form-control" id="new-button-input" type="text">
                    </div>
                    <button class="btn btn-default" id="submit-button" type="submit">Submit</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        // Topics to be displayed in initial buttons
        var topics = ["Looney Toons", "The Simpsons", "South Park"];
        // Loop through topics array to create buttons
        function updateButtons() {
            $("#buttonDisplay").empty();
            for (var i = 0; i < topics.length; i++) {
            // create new button
            var newButton = $("<button>").data("name", topics[i]).addClass("topic-button").text(topics[i]);
            // append it to the display
            $("#buttonDisplay").append(newButton);
            };
        };
        
        // On button click, get 10 static gif images and place them in the display
        $(document).on("click", ".topic-button", function() {
            // empty gif display
            $("#gifDisplay").empty();
            // create query URL from search term
            queryURL = "https://api.giphy.com/v1/gifs/search?api_key=Yi0ZBLUqIQY8KsEeCmFhpk0E7l2qD94u&limit=10&q=" + $(this).data("name");
            // AJAX call
            $.ajax({
                url: queryURL,
                method: "GET"
            }).then(function (response) {
                console.log(response.data);
                // for each item in response
                for (var i = 0; i<10; i++) {
                    // select new card elements 
                    var newCard = $("<div>").addClass("card text-center");
                    var newCardBody = $("<div>").addClass("card-body");
                    var newGif = $("<img>").attr("src", response.data[i].images.fixed_width_still.url).data("still",response.data[i].images.fixed_width_still.url).data("animate", response.data[i].images.fixed_width.url).data("state", "still").addClass("gif card-img-top");
                    var randomYear = Math.floor(Math.random() * 38) + 1980;
                    var imageTitle = $("<p>").text(response.data[i].title + " (" + randomYear + ")").addClass("card-text");
                    // append title, git, and card body to the card
                    newCardBody.append(imageTitle);
                    newCard.append(newGif, newCardBody);
                    // add skew to card
                    var skewAmount = Math.floor(Math.random() * 8)  - 4;
                    newCard.css("transform", "rotate(" + skewAmount + "deg)")
                    // append the card to the display
                    $("#gifDisplay").append(newCard);
                };
            });
        });
        // Handling clicks on images/gifs in the display area
        $(document).on("click", ".gif", function() {
            // get the image state (still or animate)
            var state = $(this).data("state");
            // if it's still, make it animated
            if (state === "still") {
                $(this).attr("src", $(this).data("animate"));
                $(this).data("state", "animate");
            // if it's animated, make it still
            } else if (state === "animate") {
                $(this).attr("src", $(this).data("still"));
                $(this).data("state", "still");
            };
        });
        // Functionality to add new buttons to starting topics
        $(document).on("click", "#submit-button", function() {
            event.preventDefault();
            topics.push($("#new-button-input").val());
            updateButtons();
        });
        updateButtons();
    </script>


</body>

</html>



<!-- // 6. Add a form to your page takes the value from a user input box and adds it into your `topics` array. Then make a function call that takes each topic in the array remakes the buttons on the page. -->

<!-- // 7. Deploy your assignment to Github Pages. -->

<!-- // 8. **Rejoice**! You just made something really cool. -->


<!-- 
// ### Bonus Goals
// 1. Ensure your app is fully mobile responsive.
// 2. Allow users to request additional gifs to be added to the page.
//    * Each request should ADD 10 gifs to the page, NOT overwrite the existing gifs.
// 3. List additional metadata (title, tags, etc) for each gif in a clean and readable format.
// 4. Include a 1-click download button for each gif, this should work across device types.
// 5. Integrate this search with additional APIs such as OMDB, or Bands in Town. Be creative and build something you are proud to showcase in your portfolio
// 6. Allow users to add their favorite gifs to a `favorites` section.
//    * This should persist even when they select or add a new topic.
//    * If you are looking for a major challenge, look into making this section persist even when the page is reloaded